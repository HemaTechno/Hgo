<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini App Coins</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <!-- Telegram SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body class="bg-gray-900 text-white flex flex-col min-h-screen">

  <!-- Header -->
  <header class="bg-gray-800 p-4 flex justify-between items-center">
    <h1 class="text-xl font-bold">๐ Mini App</h1>
    <div id="coinsBox" class="bg-blue-600 px-4 py-1 rounded-full">๐ช 0</div>
  </header>

  <!-- Pages -->
  <main id="pageTasks" class="flex-1 p-6 text-center">
    <div class="bg-gray-800 rounded-2xl p-6 shadow-lg space-y-4">
      <h2 class="text-lg">๐ฅ ุงูููุงู ุงูููููุฉ</h2>
      <div class="w-full bg-gray-700 rounded-full h-2">
        <div id="progressBar" class="bg-blue-500 h-2 rounded-full w-0"></div>
      </div>
      <p id="taskInfo">0 / 100 ุฅุนูุงู ุงูููู</p>
      <button id="watchAdBtn" class="bg-blue-600 px-4 py-2 rounded-xl">๐ฅ ุดุงูุฏ ุฅุนูุงู</button>
    </div>
  </main>

  <!-- Monetag SDK -->
  <script>
    let monetagReady = false;

    // ูุถูู ุงูุณูุฑุจุช ุจุดูู ุฏููุงูููู
    const script = document.createElement("script");
    script.src = "//libtl.com/sdk.js";
    script.setAttribute("data-zone", "9747739");
    script.setAttribute("data-sdk", "show_9747739");
    script.onload = () => {
      monetagReady = true;
      console.log("โ Monetag SDK Loaded");
    };
    script.onerror = () => {
      console.error("โ Monetag SDK failed to load");
    };
    document.body.appendChild(script);
  </script>

<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyBoPJbx5v6EkOqxOJkbhzHqIJdAByh79Rg",
    authDomain: "hhhhhh-d4fb8.firebaseapp.com",
    projectId: "hhhhhh-d4fb8",
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // User Data
  let coins = 0;
  let tasksToday = 0;
  const DAILY_LIMIT = 100;
  const userId = "guest";

  function updateUI() {
    document.getElementById("coinsBox").textContent = "๐ช " + coins;
    document.getElementById("taskInfo").textContent = tasksToday + "/" + DAILY_LIMIT + " ุฅุนูุงู ุงูููู";
    document.getElementById("progressBar").style.width = (tasksToday/DAILY_LIMIT*100)+"%";
  }

  // ุฒุฑ ูุดุงูุฏุฉ ุงูุฅุนูุงู
  document.getElementById("watchAdBtn").addEventListener("click", async () => {
    if (tasksToday >= DAILY_LIMIT) return alert("โ ูุตูุช ุงูุญุฏ ุงููููู");

    if (!monetagReady || typeof window.show_9747739 !== "function") {
      console.warn("โ๏ธ Monetag SDK ูุด ุฌุงูุฒ");
      return alert("ุงูุฅุนูุงู ูุณู ุจูุฌูุฒ.. ุฌุฑูุจ ุชุงูู ุจุนุฏ ุดููุฉ");
    }

    const btn = document.getElementById("watchAdBtn");
    btn.disabled = true;
    btn.textContent = "โณ ุฌุงุฑู ุนุฑุถ ุงูุฅุนูุงู...";

    try {
      // ุดุบู ุงูุฅุนูุงู
      window.show_9747739({
        type: 'inApp',
        inAppSettings: { interval: 5 }
      });
      console.log("๐ฅ Ad shown");

      // ูุฏุฉ ุงููุดุงูุฏุฉ
      setTimeout(async () => {
        coins++;
        tasksToday++;
        updateUI();
        alert("โ ูุณุจุช 1 ูููู ุจุนุฏ ูุดุงูุฏุฉ ุงูุฅุนูุงู");
        btn.disabled = false;
        btn.textContent = "๐ฅ ุดุงูุฏ ุฅุนูุงู";
      }, 15000); // 15 ุซุงููุฉ ุจุฏู 30 ููุชุฌุฑุจุฉ
    } catch (err) {
      console.error("โ Error showing ad:", err);
      alert("ุญุตู ุฎุทุฃ ุฃุซูุงุก ุนุฑุถ ุงูุฅุนูุงู");
      btn.disabled = false;
      btn.textContent = "๐ฅ ุดุงูุฏ ุฅุนูุงู";
    }
  });

  updateUI();
</script>
</body>
</html>



