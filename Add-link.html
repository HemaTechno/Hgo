<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù‡Ù…Ø©</title>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f7f7f7; }
    .task { border: 1px solid #ccc; padding: 10px; margin-top: 10px; background: #fff; }
    button { margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù‡Ù…Ø©</h2>
  <input type="text" id="title" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"><br><br>
  <textarea id="description" placeholder="Ø§Ù„ÙˆØµÙ"></textarea><br><br>
  
  <div id="tasks"></div>
  <button onclick="addTask()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©</button><br><br>

  <input type="text" id="finalLink" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ø¹Ø¯ ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ø§Ù…"><br><br>
  
  <input type="file" id="image"><br><br>
  
  <button onclick="createAll()">âœ… Ø¥Ù†Ø´Ø§Ø¡</button>
  <div id="result"></div>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙØ§ÙŠØ±Ø¨ÙŠØ³
    const firebaseConfig = {
  apiKey: "AIzaSyAKPlddXSZl25p9SI9H0CcPK4XSTNQXxAM",
  authDomain: "t-shirt-94ff7.firebaseapp.com",
  projectId: "t-shirt-94ff7",
  storageBucket: "t-shirt-94ff7.appspot.com",
  messagingSenderId: "367396012881",
  appId: "1:367396012881:web:3127607d5ced7678e64970"
};

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();

    let taskIndex = 0;

    function addTask() {
      const div = document.createElement('div');
      div.className = 'task';
      div.innerHTML = `
        <label>Ø§Ù„Ù…Ù†ØµØ©:</label>
        <select class="platform">
          <option value="facebook">ÙÙŠØ³Ø¨ÙˆÙƒ</option>
          <option value="discord">Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</option>
          <option value="telegram">ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</option>
          <option value="youtube">ÙŠÙˆØªÙŠÙˆØ¨</option>
          <option value="roblox">Ø±ÙˆØ¨Ù„ÙƒØ³</option>
        </select><br>
        <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù‡Ù…Ø©:</label>
        <input type="text" class="action" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø§Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©"><br>
        <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù‡Ù…Ø©:</label>
        <input type="text" class="link" placeholder="Ø¶Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§"><br>
      `;
      document.getElementById('tasks').appendChild(div);
    }

    async function createAll() {
      const title = document.getElementById('title').value.trim();
      const description = document.getElementById('description').value.trim();
      const finalLink = document.getElementById('finalLink').value.trim();
      const imageFile = document.getElementById('image').files[0];

      const taskElements = document.querySelectorAll('.task');
      const tasks = [];

      taskElements.forEach(el => {
        const platform = el.querySelector('.platform').value;
        const action = el.querySelector('.action').value.trim();
        const link = el.querySelector('.link').value.trim();
        if (platform && action && link) {
          tasks.push({ platform, action, link });
        }
      });

      let imageUrl = "";
      if (imageFile) {
        const storageRef = storage.ref('tasks/' + Date.now() + "_" + imageFile.name);
        await storageRef.put(imageFile);
        imageUrl = await storageRef.getDownloadURL();
      }

      const docRef = await db.collection("taskGroups").add({
        title,
        description,
        tasks,
        finalLink,
        imageUrl,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });

      const link = `view-task.html?id=${docRef.id}`;
      document.getElementById('result').innerHTML = `
        <p>âœ… ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­!</p>
        <input type="text" value="${link}" readonly style="width: 100%">
        <button onclick="navigator.clipboard.writeText('${link}')">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
      `;
    }
  </script>
</body>
</html>

