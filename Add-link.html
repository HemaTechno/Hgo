<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task Manager</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      padding: 0;
      background-color: #f4f4f9;
    }
    h1 {
      text-align: center;
    }
    input, textarea, select, button {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      box-sizing: border-box;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h1>Add New Task</h1>
  <input type="text" id="title" placeholder="Title" /><br>
  <textarea id="description" placeholder="Description"></textarea><br>
  <input type="text" id="imageUrl" placeholder="Image URL" /><br>
  <select id="platform" onchange="updateActions()">
    <option value="">Select Platform</option>
    <option value="YouTube">YouTube</option>
    <option value="Facebook">Facebook</option>
    <option value="WhatsApp">WhatsApp</option>
    <option value="Telegram">Telegram</option>
    <option value="Discord">Discord</option>
  </select><br>
  <select id="action">
    <option value="">Select Action</option>
  </select><br>
  <button onclick="addAction()">Add Action</button><br>
  <ul id="actionList"></ul>
  <input type="text" id="redirectUrl" placeholder="Redirect URL" /><br>
  <button onclick="addTask()">Add Task</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAKPlddXSZl25p9SI9H0CcPK4XSTNQXxAM",
      authDomain: "t-shirt-94ff7.firebaseapp.com",
      projectId: "t-shirt-94ff7",
      storageBucket: "t-shirt-94ff7.appspot.com",
      messagingSenderId: "367396012881",
      appId: "1:367396012881:web:3127607d5ced7678e64970"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const actionsMap = {
      YouTube: ["اشترك في القناة", "أعجب بالفيديو", "علق على الفيديو"],
      Facebook: ["أعجب بالصفحة", "شارك المنشور", "علق على المنشور"],
      WhatsApp: ["انضم للجروب", "ارسل رسالة"],
      Telegram: ["انضم للقناة", "انضم للجروب"],
      Discord: ["انضم للسيرفر", "تفاعل في قناة"]
    };

    let actions = [];

    window.updateActions = function() {
      const platform = document.getElementById('platform').value;
      const actionSelect = document.getElementById('action');
      actionSelect.innerHTML = '<option value="">Select Action</option>';

      if (actionsMap[platform]) {
        actionsMap[platform].forEach(action => {
          const option = document.createElement('option');
          option.value = action;
          option.textContent = action;
          actionSelect.appendChild(option);
        });
      }
    }

    window.addAction = function() {
      const platform = document.getElementById('platform').value;
      const action = document.getElementById('action').value;

      if (platform && action) {
        actions.push({ platform, action });
        const actionList = document.getElementById('actionList');
        const li = document.createElement('li');
        li.textContent = `${platform}: ${action}`;
        actionList.appendChild(li);
      }
    }

    window.addTask = async function() {
      const title = document.getElementById('title').value;
      const description = document.getElementById('description').value;
      const imageUrl = document.getElementById('imageUrl').value;
      const redirectUrl = document.getElementById('redirectUrl').value;

      const taskData = {
        title,
        description,
        imageUrl,
        actions,
        redirectUrl,
        createdAt: new Date()
      };

      const docRef = await addDoc(collection(db, 'tasks'), taskData);
      const link = `${window.location.origin}/task.html?id=${docRef.id}`;
      alert(`تمت إضافة المهمة! انسخ الرابط: ${link}`);

      // إعادة تعيين البيانات
      actions = [];
      document.getElementById('actionList').innerHTML = '';
    }
  </script>
</body>
</html>



